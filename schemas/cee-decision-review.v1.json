{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://olumi.ai/schemas/cee-decision-review.v1.json",
  "title": "CeeDecisionReviewPayload",
  "description": "Frozen v1 contract for CEE decision review. Additive-only evolution.",
  "type": "object",
  "required": ["schema", "version", "decision_id", "review"],
  "properties": {
    "schema": {
      "const": "cee.decision-review.v1"
    },
    "version": {
      "const": "1.0.0"
    },
    "decision_id": {
      "type": "string",
      "minLength": 1
    },
    "scenario_id": {
      "type": ["string", "null"]
    },
    "review": {
      "$ref": "#/definitions/Review"
    },
    "trace": {
      "$ref": "#/definitions/Trace"
    },
    "meta": {
      "$ref": "#/definitions/Meta"
    }
  },
  "definitions": {
    "Review": {
      "type": "object",
      "required": ["summary", "confidence", "recommendations"],
      "properties": {
        "summary": {
          "type": "string",
          "description": "Plain-English summary of decision quality"
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "quality_band": {
          "type": "string",
          "enum": ["high", "medium", "low"]
        },
        "recommendations": {
          "type": "array",
          "items": { "$ref": "#/definitions/Recommendation" }
        },
        "bias_findings": {
          "type": "array",
          "items": { "$ref": "#/definitions/BiasFinding" }
        },
        "structural_issues": {
          "type": "array",
          "items": { "$ref": "#/definitions/StructuralIssue" }
        },
        "strengths": {
          "type": "array",
          "items": { "type": "string" }
        }
      }
    },
    "Recommendation": {
      "type": "object",
      "required": ["id", "priority", "message"],
      "properties": {
        "id": { "type": "string" },
        "priority": { "type": "string", "enum": ["high", "medium", "low"] },
        "message": { "type": "string" },
        "action": { "type": "string" },
        "affected_nodes": {
          "type": "array",
          "items": { "type": "string" }
        }
      }
    },
    "BiasFinding": {
      "type": "object",
      "required": ["code", "severity", "message"],
      "properties": {
        "code": { "type": "string" },
        "severity": { "type": "string", "enum": ["critical", "high", "medium", "low"] },
        "message": { "type": "string" },
        "confidence": { "type": "number", "minimum": 0, "maximum": 1 },
        "affected_node_ids": {
          "type": "array",
          "items": { "type": "string" }
        },
        "micro_intervention": {
          "type": "object",
          "properties": {
            "steps": { "type": "array", "items": { "type": "string" } },
            "estimated_minutes": { "type": "integer" }
          }
        }
      }
    },
    "StructuralIssue": {
      "type": "object",
      "required": ["code", "severity", "message"],
      "properties": {
        "code": { "type": "string" },
        "severity": { "type": "string", "enum": ["error", "warning", "info"] },
        "message": { "type": "string" },
        "affected_node_ids": {
          "type": "array",
          "items": { "type": "string" }
        }
      }
    },
    "Trace": {
      "type": "object",
      "properties": {
        "request_id": { "type": "string" },
        "correlation_id": { "type": "string" },
        "latency_ms": { "type": "integer" },
        "model_version": { "type": "string" }
      }
    },
    "Meta": {
      "type": "object",
      "properties": {
        "created_at": { "type": "string", "format": "date-time" },
        "graph_hash": { "type": "string" },
        "seed": { "type": "integer" }
      }
    }
  },
  "additionalProperties": false
}
